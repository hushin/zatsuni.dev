---
import { slugifyStr } from "@utils/slugify";
import Datetime from "./Datetime.astro";
import type { CollectionEntry } from "astro:content";

export interface Props {
  href?: string;
  frontmatter: CollectionEntry<"blog">["data"];
}

const { href, frontmatter } = Astro.props;
const { title, pubDatetime, modDatetime, description, tags, featured } =
  frontmatter;

const headerProps = {
  style: `view-transition-name: ${slugifyStr(title)}`,
  class: "card-title text-lg font-semibold",
};
---

<li class="mb-6">
  <div class="card bg-base-100 border-base-300 border shadow-sm">
    <div class="card-body p-6">
      <a href={href} class="link link-primary">
        <h2 {...headerProps}>
          {title}
          {featured && <div class="badge badge-primary badge-sm">Featured</div>}
        </h2>
      </a>

      <Datetime pubDatetime={pubDatetime} modDatetime={modDatetime} />

      {
        description && (
          <p class="text-base-content/80 mt-2 line-clamp-2 text-sm">
            {description}
          </p>
        )
      }

      {
        tags && tags.length > 0 && (
          <div class="card-actions mt-4 justify-start">
            {tags.slice(0, 3).map((tag: string) => (
              <div class="badge badge-outline badge-xs">{tag}</div>
            ))}
            {tags.length > 3 && (
              <div class="badge badge-ghost badge-xs">+{tags.length - 3}</div>
            )}
          </div>
        )
      }
    </div>
  </div>
</li>
